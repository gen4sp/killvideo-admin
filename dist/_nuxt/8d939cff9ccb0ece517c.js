(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1153:function(e,t,l){var content=l(1164);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(53).default)("430bfc94",content,!0,{sourceMap:!1})},1154:function(e,t,l){var content=l(1166);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(53).default)("24c382d3",content,!0,{sourceMap:!1})},1155:function(e,t,l){var content=l(1168);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(53).default)("50f6329c",content,!0,{sourceMap:!1})},1163:function(e,t,l){"use strict";var o=l(1153);l.n(o).a},1164:function(e,t,l){(t=l(52)(!1)).push([e.i,".json-wrapper{height:200px;overflow:scroll;background-color:#eee}.loader{width:100%;height:100%;display:flex;justify-content:center;align-items:center}",""]),e.exports=t},1165:function(e,t,l){"use strict";var o=l(1154);l.n(o).a},1166:function(e,t,l){(t=l(52)(!1)).push([e.i,".preview[data-v-e06695fe]{width:100%;height:200px}.preview.image[data-v-e06695fe]{background-size:contain;background-color:#eee;background-repeat:no-repeat;background-position:50%}",""]),e.exports=t},1167:function(e,t,l){"use strict";var o=l(1155);l.n(o).a},1168:function(e,t,l){(t=l(52)(!1)).push([e.i,".poster{width:100px;height:100px;background-size:cover;background-position:50%}",""]),e.exports=t},1177:function(e,t,l){"use strict";l.r(t);l(187);var o=l(1151),r=l.n(o),n={components:{},props:["url"],data:function(){return{jsondata:{},loading:!1}},watch:{url:function(){this.fetch()}},mounted:function(){this.fetch()},methods:{fetch:function(){var e=this;this.loading=!0,this.jsondata={},console.log("URL",this.url),this.$axios.$get(this.url,{headers:{"Access-Control-Origin":"*","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST","Access-Control-Allow-Headers":"Content-Type"}}).then((function(t){e.loading=!1,console.log("=-=-=-=-=",t),e.jsondata=t}))}}},c=(l(1163),l(38)),d={components:{JsonViewer:Object(c.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"json-wrapper"},[this.loading?t("div",{staticClass:"loader"},[t("a-spin")],1):t("vue-json-pretty",{attrs:{data:this.jsondata}})],1)}),[],!1,null,null,null).exports},props:["actionUrl","accept","value","previewType"],data:function(){return{valueUrl:null,fileList:[],jsonValue:{},loading:!1}},computed:{aeUploaded:function(){return this.fileList.length>0},shortValue:function(){return r.a.takeRight(this.value.split("/"))[0]}},mounted:function(){this.value&&(this.fileList=this.value)},methods:{openPreview:function(){var e=this.valueUrl||"http://cdn.killvideo.tv/".concat(this.value);window.open(e,"_blank")},removeHandle:function(e){this.fileList=[],this.$emit("remove"),this.$emit("input",null)},handleRemove:function(e){this.fileList=[]},upload:function(e){var t=this;return this.loading=!0,this.$api.upload(e.file,e.action).then((function(e){t.loading=!1,console.log(" >>> ",e),console.log("=== ",e.data.files,e.data.files[0]),t.valueUrl="http://cdn.killvideo.tv/".concat(e.data.files[0].path),t.$emit("uploaded",e.data.files[0].path),t.$emit("input",e.data.files[0].path)}))}}},m=(l(1165),Object(c.a)(d,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[e.value?l("div",[l("a",{on:{click:e.openPreview}},[e._v(e._s(e.shortValue))]),e._v(" "),l("div",["image"===e.previewType?l("div",{staticClass:"preview image",style:{backgroundImage:"url(http://cdn.killvideo.tv/"+e.value+")"}}):"video"===e.previewType?l("video",{staticClass:"preview",attrs:{width:"320",height:"240",controls:""}},[l("source",{attrs:{src:"http://cdn.killvideo.tv/"+e.value,type:"video/mp4"}}),e._v("\n        Your browser does not support the video tag.\n      ")]):"json"===e.previewType?l("JsonViewer",{attrs:{url:"http://cdn.killvideo.tv/"+e.value}}):e._e()],1),e._v(" "),l("a-button",{on:{click:e.removeHandle}},[l("a-icon",{attrs:{type:"delete"}})],1)],1):l("a-upload",{attrs:{name:"file",multiple:!1,accept:e.accept,"file-list":e.fileList,action:e.actionUrl,"custom-request":e.upload,remove:e.removeHandle}},[l("a-button",{attrs:{loading:e.loading,disabled:e.loading}},[l("a-icon",{attrs:{type:"upload"}}),e._v("\n      "+e._s(e.value?"uploaded":e.loading?"Uploadinig...":"Click to Upload")+"\n    ")],1)],1)],1)}),[],!1,null,"e06695fe",null).exports),f={title:null,id:null,aeUrl:null,jsonUrl:null,coverUrl:null,tags:[],previewUrl:null,visibility:"public"},h={components:{UploadItem:m},props:["visible","template"],data:function(){return{form:r.a.clone(f),labelCol:{span:6},wrapperCol:{span:14},rules:{title:[{required:!0,message:"Please input a title",trigger:"blur"}],visibility:[{required:!0,message:"Please select a visibility",trigger:"change"}],aeUrl:[{required:!0,message:"Please pick a file",trigger:"change"}],jsonUrl:[{required:!0,message:"Please pick a file",trigger:"change"}],coverUrl:[{required:!0,message:"Please pick a file",trigger:"change"}],previewUrl:[{required:!0,message:"Please pick a file",trigger:"change"}]}}},computed:{},watch:{visible:function(e){this.resetForm(),e&&this.template&&(this.form.title=this.template.title,this.form.id=this.template.id,this.form.aeUrl=this.template.ae_path,this.form.jsonUrl=this.template.json_path,this.form.coverUrl=this.template.poster,this.form.previewUrl=this.template.preview,this.form.tags=this.template.tags,"public"===this.template.visibility||"hidden"===this.template.visibility?this.form.visibility=this.template.visibility:(this.form.visibility="private",this.form.userIds=this.template.visibility.split(","))),console.log("zz",e,this.template,this.form)}},methods:{prepareFormData:function(){var e={};return e.title=this.form.title,e.ae_path=this.form.aeUrl,e.json_path=this.form.jsonUrl,e.poster=this.form.coverUrl,e.preview=this.form.previewUrl,e.tags=this.form.tags,e.id=this.form.id,"public"===this.form.visibility||"hidden"===this.form.visibility?e.visibility=this.form.visibility:e.visibility=this.form.userIds.join(","),e},uploadedHanlde:function(e,t){return function(a,b){}},actionUrl:function(e){return this.template?"/templates/".concat(this.template.id,"/upload/").concat(e):"/templates/temp/upload/".concat(e)},handleOk:function(e){this.onSubmit()},handleCancel:function(e){this.$emit("onClose")},onSubmit:function(){var e=this;console.log(" == ",this.form),this.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;var l=e.prepareFormData();e.$emit("onClose",l)}))},resetForm:function(){this.$refs.ruleForm&&this.$refs.ruleForm.resetFields()}}},v=Object(c.a)(h,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("a-modal",{attrs:{visible:e.visible,title:"Add or edit template","ok-text":"Save"},on:{ok:e.handleOk,cancel:e.handleCancel}},[l("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[l("a-form-model-item",{ref:"title",attrs:{label:"Title",prop:"title"}},[l("a-input",{attrs:{placeholder:"Title"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),l("a-form-model-item",{ref:"visibility",attrs:{label:"Visibility",prop:"visibility"}},[l("div",{staticStyle:{display:"flex"}},[l("a-select",{staticStyle:{width:"120px"},model:{value:e.form.visibility,callback:function(t){e.$set(e.form,"visibility",t)},expression:"form.visibility"}},[l("a-select-option",{attrs:{value:"public"}},[e._v("\n            public\n          ")]),e._v(" "),l("a-select-option",{attrs:{value:"private"}},[e._v("\n            private\n          ")]),e._v(" "),l("a-select-option",{attrs:{value:"hidden"}},[e._v("\n            hidden\n          ")])],1),e._v(" "),"private"===e.form.visibility?l("a-select",{attrs:{placeholder:"User IDs who can see",mode:"tags"},model:{value:e.form.userIds,callback:function(t){e.$set(e.form,"userIds",t)},expression:"form.userIds"}}):e._e()],1)]),e._v(" "),l("a-form-model-item",{ref:"tags",attrs:{label:"Tags",prop:"tags"}},[l("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Enter tags here",mode:"tags"},model:{value:e.form.tags,callback:function(t){e.$set(e.form,"tags",t)},expression:"form.tags"}})],1),e._v(" "),l("a-form-model-item",{attrs:{label:"AE file",prop:"aeUrl"}},[l("upload-item",{attrs:{"action-url":e.actionUrl("ae"),accept:".aep"},on:{uploaded:function(t){return e.uploadedHanlde("ae",t)}},model:{value:e.form.aeUrl,callback:function(t){e.$set(e.form,"aeUrl",t)},expression:"form.aeUrl"}})],1),e._v(" "),l("a-form-model-item",{attrs:{label:"JSON file",prop:"jsonUrl"}},[l("upload-item",{attrs:{"preview-type":"json","action-url":e.actionUrl("json"),accept:".json"},model:{value:e.form.jsonUrl,callback:function(t){e.$set(e.form,"jsonUrl",t)},expression:"form.jsonUrl"}})],1),e._v(" "),l("a-form-model-item",{attrs:{label:"Cover image",prop:"coverUrl"}},[l("upload-item",{attrs:{"preview-type":"image","action-url":e.actionUrl("cover"),accept:".jpeg"},model:{value:e.form.coverUrl,callback:function(t){e.$set(e.form,"coverUrl",t)},expression:"form.coverUrl"}})],1),e._v(" "),l("a-form-model-item",{attrs:{label:"Video preview",prop:"previewUrl"}},[l("upload-item",{attrs:{"preview-type":"video","action-url":e.actionUrl("preview"),accept:".mp4"},model:{value:e.form.previewUrl,callback:function(t){e.$set(e.form,"previewUrl",t)},expression:"form.previewUrl"}})],1)],1)],1)}),[],!1,null,null,null).exports,w=[{dataIndex:"poster",key:"poster",scopedSlots:{customRender:"img"},width:140},{title:"Title",dataIndex:"title",key:"title"},{title:"Renders",dataIndex:"count",key:"count"},{title:"Tags",key:"tags",dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:"Action",key:"action",scopedSlots:{customRender:"action"},width:190}],y={components:{EditTemplate:v},middleware:"authguard",data:function(){return{loading:!1,selectedTemplate:null,editTemplateModalShown:!1,templates:[],columns:w}},mounted:function(){this.fetch()},methods:{EditTemplateModalOnCloseHandle:function(data){var e=this;console.log(" O ",data),data?data.id?this.$api.apiCall({method:"POST",url:"/templates/".concat(data.id),data:data}).then((function(data){console.log("td edit",data),e.closeEditTemplate(),e.fetch()})):this.$api.apiCall({method:"POST",url:"/templates/",data:data}).then((function(data){console.log("td creatre ",data),e.closeEditTemplate()})):this.closeEditTemplate()},closeEditTemplate:function(){this.selectedTemplate=null,this.editTemplateModalShown=!1},openEditTemplate:function(template){this.selectedTemplate=template,this.editTemplateModalShown=!0,console.log("sfs",template)},gotoNewChannel:function(){this.$router.push("/channel/")},fetch:function(){var e=this;return this.loading=!0,this.$api.apiCall({method:"GET",url:"/templates/"}).then((function(data){console.log("td ",data),e.loading=!1,e.templates=data.data}))}}},k=(l(1167),Object(c.a)(y,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("a-button",{on:{click:function(t){return e.openEditTemplate()}}},[e._v("+")]),e._v(" "),l("a-table",{attrs:{columns:e.columns,"data-source":e.templates,loading:e.loading,"row-key":"id"},scopedSlots:e._u([{key:"name",fn:function(text){return l("a",{},[e._v(e._s(text))])}},{key:"img",fn:function(text){return l("span",{},[l("div",{staticClass:"poster",style:{backgroundImage:"url('http://cdn.killvideo.tv/"+text.split("\\").join("\\\\")+"')"}})])}},{key:"tags",fn:function(t){return l("span",{},e._l(t,(function(t){return l("a-tag",{key:t,attrs:{color:"loser"===t?"volcano":t.length>5?"geekblue":"green"}},[e._v("\n        "+e._s(t.toUpperCase())+"\n      ")])})),1)}},{key:"action",fn:function(t){return l("span",{},[l("a",{on:{click:function(l){return e.openEditTemplate(t)}}},[e._v("Edit")]),e._v(" "),l("a-divider",{attrs:{type:"vertical"}}),e._v(" "),l("a",{staticClass:"ant-dropdown-link"},[e._v(" More actions "),l("a-icon",{attrs:{type:"down"}})],1)],1)}}])}),e._v(" "),l("EditTemplate",{attrs:{template:e.selectedTemplate,visible:e.editTemplateModalShown},on:{onClose:e.EditTemplateModalOnCloseHandle}})],1)}),[],!1,null,null,null));t.default=k.exports}}]);